        /* Routing Observability Panel */
        .routing-obs-panel {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: var(--spacing-lg);
            margin-bottom: var(--gap-comfortable);
        }
        .routing-obs-panel h4 {
            margin: 0 0 12px 0;
            font-size: var(--font-base);
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        .routing-obs-kpis {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(min(100px, 100%), 1fr));
            gap: var(--spacing-sm);
            margin-bottom: 12px;
        }
        .routing-obs-kpi {
            text-align: center;
            padding: var(--spacing-sm);
            background: var(--bg-secondary);
            border-radius: 8px;
        }
        .routing-obs-kpi .label {
            font-size: var(--font-xs);
            color: var(--text-secondary);
            text-transform: uppercase;
            margin-bottom: 4px;
        }
        .routing-obs-kpi .value {
            font-size: 1.1rem;
            font-weight: 600;
            font-variant-numeric: tabular-nums;
        }
        .routing-obs-chart-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(min(250px, 100%), 1fr));
            gap: var(--spacing-sm);
            margin-bottom: 12px;
        }
        .routing-obs-chart-container {
            background: var(--bg-secondary);
            border-radius: 8px;
            padding: var(--spacing-md);
            margin-bottom: 8px;
            position: relative;
            height: 180px;
            overflow: hidden;
        }
        .routing-obs-chart-title {
            font-size: var(--font-sm);
            color: var(--text-secondary);
            text-transform: uppercase;
            margin-bottom: 6px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .routing-obs-time-selector {
            display: flex;
            gap: var(--spacing-xs);
        }
        .routing-obs-time-selector .time-range-btn {
            padding: var(--spacing-xs, 4px) var(--spacing-sm, 8px);
            font-size: var(--font-xs);
        }

        /* Routing page tabs */
        .routing-tabs {
            background: var(--bg-primary);
            border-radius: var(--radius);
            border: 1px solid var(--border);
            overflow: hidden;
        }
        .routing-tab-nav {
            display: flex;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border);
            overflow-x: auto;
        }
        .routing-tab-btn {
            padding: var(--spacing-sm) var(--spacing-md);
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: var(--font-base);
            font-weight: 500;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            white-space: nowrap;
            transition: all var(--dur) var(--ease);
        }
        .routing-tab-btn:hover {
            color: var(--text-primary);
            background: var(--surface-overlay);
        }
        .routing-tab-btn.active {
            color: var(--accent);
            border-bottom-color: var(--accent);
        }
        .routing-tab-panel { display: none; }
        .routing-tab-panel.active { display: block; }
        .routing-tab-content { padding: var(--spacing-lg); }

        /* Explain result styles */
        .routing-explain-section {
            margin-top: var(--spacing-lg);
            padding-top: var(--spacing-lg);
            border-top: 1px solid var(--border);
        }
        .explain-result-container {
            margin-top: var(--spacing-md);
        }
        .explain-result {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: var(--spacing-md);
        }
        .explain-summary {
            font-size: 1rem;
            margin-bottom: var(--spacing-sm);
        }
        .explain-reason {
            color: var(--text-secondary);
            font-size: var(--font-base);
            margin-bottom: var(--spacing-md);
            font-family: var(--font-mono);
            word-break: break-word;
        }
        .explain-scoring-table {
            width: 100%;
            border-collapse: collapse;
            font-size: var(--font-base);
            margin-bottom: var(--spacing-md);
        }
        .explain-scoring-table th,
        .explain-scoring-table td {
            padding: var(--spacing-xs) var(--spacing-sm);
            border-bottom: 1px solid var(--border);
            text-align: left;
        }
        .explain-scoring-table th {
            color: var(--text-secondary);
            font-weight: 600;
        }
        .explain-scoring-table tr.selected {
            background: color-mix(in srgb, var(--accent) 15%, transparent);
        }
        .explain-cooldowns {
            margin-bottom: var(--spacing-md);
            font-size: var(--font-base);
        }
        .explain-cooldowns ul {
            margin: var(--spacing-xs) 0 0 var(--spacing-md);
            padding: 0;
        }
        .explain-features {
            font-size: var(--font-base);
            color: var(--text-secondary);
        }
        .explain-features pre {
            background: var(--bg-primary);
            padding: var(--spacing-sm);
            border-radius: var(--radius);
            overflow-x: auto;
            margin-top: var(--spacing-xs);
        }
        .strategy-label {
            font-size: var(--font-sm);
            padding: 2px 6px;
            border-radius: 3px;
            background: var(--bg-tertiary, var(--border-subtle));
            color: var(--text-secondary);
        }

        /* Tables should scroll horizontally if too wide, not break layout */
        .routing-tier-table,
        .routing-cooldown-table,
        .routing-override-table,
        .routing-rules-table,
        .routing-model-usage-table {
            table-layout: fixed;
        }

        /* Wrap tables that might overflow */
        .table-scroll-wrapper {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        /* Model Routing Panel */
        .model-routing-panel {
            background: var(--bg-card);
            border-radius: 12px;
            padding: var(--spacing-lg);
            border: 1px solid var(--border);
        }
        .model-routing-panel h3 {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            font-size: var(--font-md);
        }
        .routing-status {
            display: flex;
            gap: var(--spacing-md);
            flex-wrap: wrap;
            margin-bottom: 12px;
        }
        .routing-status .status-badge {
            display: inline-flex;
            align-items: center;
            gap: var(--spacing-xs);
            padding: var(--spacing-xs, 4px) var(--spacing-sm, 8px);
            border-radius: 4px;
            font-size: var(--font-sm);
            font-weight: 600;
        }
        .routing-status .status-badge.enabled {
            background: color-mix(in srgb, var(--success, #22c55e) 15%, transparent);
            color: var(--success);
        }
        .routing-status .status-badge.disabled {
            background: color-mix(in srgb, var(--error, #ef4444) 15%, transparent);
            color: var(--error);
        }
        .routing-status .persist-badge {
            display: inline-flex;
            align-items: center;
            gap: var(--spacing-xs);
            padding: var(--spacing-xs, 4px) var(--spacing-sm, 8px);
            border-radius: 4px;
            font-size: var(--font-sm);
            font-weight: 600;
            cursor: default;
        }
        .routing-status .persist-badge.badge-success {
            background: color-mix(in srgb, var(--success, #22c55e) 15%, transparent);
            color: var(--success);
        }
        .routing-status .persist-badge.badge-warning {
            background: color-mix(in srgb, var(--warning, #eab308) 15%, transparent);
            color: var(--warning, #eab308);
        }
        .persist-warning {
            background: color-mix(in srgb, var(--warning, #eab308) 15%, transparent);
            border: 1px solid var(--warning, #eab308);
            color: var(--warning, #eab308);
            padding: var(--spacing-sm) var(--spacing-md);
            border-radius: 6px;
            margin: var(--spacing-sm) 0 12px 0;
            font-size: 0.85em;
            line-height: 1.4;
        }
        .persist-warning code {
            background: var(--border-subtle);
            padding: var(--spacing-xs, 4px) var(--spacing-sm, 8px);
            border-radius: 3px;
            font-size: 0.9em;
        }
        .routing-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: var(--spacing-sm);
            margin-bottom: 12px;
        }
        .routing-stat-item {
            text-align: center;
            padding: var(--spacing-sm);
            background: var(--bg-secondary);
            border-radius: 6px;
        }
        .routing-stat-item .label {
            font-size: var(--font-xs);
            color: var(--text-secondary);
            text-transform: uppercase;
        }
        .routing-stat-item .value {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary);
        }
        .routing-tier-table, .routing-cooldown-table, .routing-override-table, .routing-rules-table, .routing-model-usage-table {
            width: 100%;
            border-collapse: collapse;
            font-size: var(--font-base);
            margin-bottom: 12px;
        }
        .routing-tier-table th, .routing-cooldown-table th, .routing-override-table th, .routing-rules-table th, .routing-model-usage-table th {
            text-align: left;
            padding: var(--spacing-sm) 8px;
            border-bottom: 1px solid var(--border);
            color: var(--text-secondary);
            font-size: var(--font-sm);
            text-transform: uppercase;
        }
        .routing-tier-table td, .routing-cooldown-table td, .routing-override-table td, .routing-rules-table td, .routing-model-usage-table td {
            padding: var(--spacing-sm) 8px;
            border-bottom: 1px solid color-mix(in srgb, var(--border, #334155) 30%, transparent);
        }
        /* Fallback Chain Visualization */
        .fallback-chains {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-sm);
            margin-bottom: 12px;
        }
        .fallback-chain-row {
            display: flex;
            align-items: center;
            gap: 0;
            font-size: var(--font-base);
            flex-wrap: wrap;
        }
        .fallback-chain-label {
            color: var(--text-secondary);
            font-size: var(--font-sm);
            text-transform: uppercase;
            min-width: 55px;
            margin-right: 6px;
        }
        .chain-node {
            display: inline-flex;
            align-items: center;
            gap: var(--spacing-xs);
            padding: 3px 10px;
            border-radius: 4px;
            background: rgba(99, 102, 241, 0.15);
            color: #818cf8;
            font-family: var(--font-mono);
            font-size: var(--font-sm);
        }
        .chain-node.primary { background: rgba(99, 102, 241, 0.25); border: 1px solid rgba(99, 102, 241, 0.4); }
        .chain-node.available { background: rgba(16, 185, 129, 0.15); color: #10b981; }
        .chain-node.cooled { background: rgba(245, 158, 11, 0.15); color: #f59e0b; }
        .chain-arrow {
            color: var(--text-secondary);
            margin: 0 4px;
            font-size: var(--font-base);
        }
        .chain-status {
            font-size: var(--font-sm);
            margin-left: 2px;
            display: inline-flex;
            align-items: center;
            gap: var(--spacing-xs, 4px);
        }
        .chain-status-cooled {
            color: #f59e0b;
            font-weight: 600;
        }
        .chain-status-available {
            color: #10b981;
        }
        .chain-model-name {
            font-weight: 500;
        }
        /* Nest tier badge inside chain node */
        .chain-node .tier-badge {
            margin-left: 4px;
            font-size: 0.55rem;
            padding: var(--spacing-xs, 4px);
        }

        /* Model Pool Status */
        .model-pools {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-md);
        }
        .pool-tier-group {
            background: var(--bg-secondary);
            border-radius: 6px;
            padding: var(--spacing-sm) 10px;
        }
        .pool-tier-header {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            margin-bottom: 6px;
            font-size: var(--font-sm);
        }
        .pool-tier-name {
            font-weight: 600;
            text-transform: capitalize;
            color: var(--text-primary);
        }
        .pool-tier-slots {
            color: var(--text-secondary);
        }
        .pool-tier-util {
            margin-left: auto;
            color: var(--accent);
            font-weight: 600;
            font-family: var(--font-mono);
        }
        .pool-model-row {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            margin-bottom: 3px;
            font-size: var(--font-sm);
        }
        .pool-model-name {
            min-width: 90px;
            color: var(--text-secondary);
            font-family: var(--font-mono);
        }
        .pool-bar-track {
            flex: 1;
            height: 6px;
            background: var(--surface-overlay-hover);
            border-radius: 3px;
            overflow: hidden;
        }
        .pool-bar-fill {
            height: 100%;
            border-radius: 3px;
            transition: width calc(var(--dur) * 1.67) var(--ease);
        }
        .pool-bar-low { background: var(--success, #22c55e); }
        .pool-bar-medium { background: var(--warning, #eab308); }
        .pool-bar-high { background: var(--error, #ef4444); }
        .pool-bar-cooled { background: var(--text-secondary, #6b7280); }
        .pool-model-count {
            min-width: 30px;
            text-align: right;
            font-family: var(--font-mono);
            color: var(--text-secondary);
        }
        .pool-model-cooldown {
            color: var(--warning, #eab308);
            font-weight: 600;
            font-size: var(--font-xs);
        }

        /* Editable Tier Inputs */
        .tier-edit-input {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            color: var(--text-primary);
            padding: var(--spacing-xs, 4px) var(--spacing-sm, 8px);
            border-radius: 3px;
            font-size: var(--font-sm);
            font-family: var(--font-mono);
            width: 100%;
        }
        .tier-edit-input:focus {
            border-color: var(--accent);
            outline: none;
        }
        .tier-edit-select {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            color: var(--text-primary);
            padding: 2px 4px;
            border-radius: 3px;
            font-size: var(--font-sm);
        }

        /* ========== TIER BUILDER (Drag-and-Drop) ========== */
        .tier-builder {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-md, 12px);
            position: relative;
        }

        /* Upgrade Info Panel (UIUX-02) */
        .upgrade-info-panel {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg, 8px);
            margin-bottom: var(--spacing-lg, 16px);
            overflow: hidden;
        }

        .upgrade-info-toggle {
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--spacing-md, 12px);
            background: transparent;
            border: none;
            color: var(--text-primary);
            cursor: pointer;
            font-weight: 600;
            font-size: var(--font-sm, 0.85rem);
        }

        .upgrade-info-toggle:hover {
            background: var(--bg-secondary);
        }

        .upgrade-info-toggle .chevron {
            transition: transform 0.2s ease;
        }

        .upgrade-info-toggle.expanded .chevron {
            transform: rotate(180deg);
        }

        .upgrade-info-content {
            padding: 0 var(--spacing-md, 12px) var(--spacing-md, 12px);
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease, padding 0.3s ease;
        }

        .upgrade-info-content.expanded {
            max-height: 500px;
            padding: 0 var(--spacing-md, 12px) var(--spacing-md, 12px);
        }

        .upgrade-info-content p {
            font-size: var(--font-sm, 0.85rem);
            color: var(--text-primary);
            margin: var(--spacing-sm, 8px) 0;
        }

        .upgrade-triggers-list {
            list-style: none;
            padding: 0;
            margin: var(--spacing-md, 12px) 0;
        }

        .upgrade-triggers-list li {
            padding: var(--spacing-sm, 8px) var(--spacing-md, 12px);
            background: var(--bg-secondary);
            border-radius: var(--radius-sm, 4px);
            margin-bottom: var(--spacing-sm, 8px);
            font-family: var(--font-mono);
            font-size: var(--font-sm, 0.75rem);
            color: var(--text-primary);
        }

        .upgrade-info-note {
            font-size: var(--font-sm, 0.75rem);
            color: var(--text-secondary);
            margin-top: var(--spacing-md, 12px);
        }

        .upgrade-info-note code {
            background: var(--bg-secondary);
            padding: 2px 6px;
            border-radius: var(--radius-sm, 4px);
            font-family: var(--font-mono);
            font-size: 0.9em;
        }

        /* Available Models Bank */
        .models-bank {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm, 4px);
            padding: var(--spacing-sm, 8px);
        }
        .models-bank-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-sm, 8px);
        }
        .models-bank-title {
            font-size: var(--font-xs, 0.75rem);
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .models-bank-count {
            font-size: var(--font-xs, 0.75rem);
            color: var(--text-secondary);
            background: var(--bg-secondary);
            padding: 1px 6px;
            border-radius: var(--radius-sm, 4px);
        }
        .models-bank-list {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-sm, 8px);
            min-height: 40px;
            padding: var(--spacing-sm, 8px) 0;
        }

        /* Tier Lanes */
        .tier-lanes {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: var(--spacing-md, 12px);
        }
        .tier-lane {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm, 4px);
            padding: var(--spacing-sm, 8px);
            min-height: 100px;
            transition: border-color var(--dur, 0.2s) var(--ease, ease);
        }
        .tier-lane:hover {
            border-color: var(--accent);
        }
        .tier-lane-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-sm, 8px);
            padding-bottom: var(--spacing-sm, 8px);
            border-bottom: 1px solid var(--border);
        }
        .tier-lane-name {
            font-size: var(--font-sm, 0.85rem);
            font-weight: 600;
            color: var(--text-primary);
        }
        .tier-lane[data-tier="heavy"] .tier-lane-name { color: var(--error, #ef4444); }
        .tier-lane[data-tier="medium"] .tier-lane-name { color: var(--warning, #f59e0b); }
        .tier-lane[data-tier="light"] .tier-lane-name { color: var(--success, #10b981); }
        .tier-lane-strategy {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm, 4px);
            color: var(--text-primary);
            font-size: var(--font-xs, 0.75rem);
            padding: 2px 6px;
            cursor: pointer;
        }
        .tier-lane-strategy:focus {
            border-color: var(--accent);
            outline: none;
        }
        .tier-lane-models {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-sm, 8px);
            min-height: 60px;
            padding: 4px 0;
        }
        .tier-lane-empty,
        .tier-builder-empty {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 48px;
            color: var(--text-secondary);
            font-size: var(--font-xs, 0.75rem);
            font-style: italic;
            opacity: 0.7;
        }

        /* Model Card (draggable) */
        .model-card {
            display: flex;
            flex-direction: column;
            gap: 4px;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm, 4px);
            padding: var(--spacing-sm, 8px);
            cursor: grab;
            transition: transform var(--dur, 0.2s) var(--ease, ease),
                        box-shadow var(--dur, 0.2s) var(--ease, ease);
            position: relative;
            user-select: none;
        }
        .model-card:hover {
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
            transform: translateY(-1px);
        }
        .model-card:active {
            cursor: grabbing;
        }
        .model-card-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 4px;
        }
        .model-card-name {
            font-size: var(--font-xs, 0.75rem);
            font-weight: 600;
            color: var(--text-primary);
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            flex: 1;
        }
        .model-card-position {
            font-size: var(--font-xs);
            color: var(--text-secondary);
            background: var(--bg-card);
            padding: 0 4px;
            border-radius: 2px;
            min-width: 16px;
            text-align: center;
        }
        .model-card-badges {
            display: flex;
            gap: 4px;
            flex-wrap: wrap;
        }
        .model-card-shared {
            font-size: var(--font-xs);
            color: var(--warning, #f59e0b);
            background: color-mix(in srgb, var(--warning, #f59e0b) 10%, transparent);
            padding: 1px 4px;
            border-radius: 2px;
            font-weight: 600;
            text-transform: uppercase;
        }
        .model-card-cooldown {
            font-size: var(--font-xs);
            color: var(--error, #ef4444);
            background: color-mix(in srgb, var(--error, #ef4444) 10%, transparent);
            padding: 1px 4px;
            border-radius: 2px;
            font-weight: 600;
        }

        .model-card-shadow {
            font-size: var(--font-xs);
            color: var(--info, #3b82f6);
            background: color-mix(in srgb, var(--info, #3b82f6) 10%, transparent);
            padding: 1px 4px;
            border-radius: 2px;
            font-weight: 600;
            text-transform: uppercase;
        }

        /* Busy State Indicator (UIUX-03) */
        .model-busy-indicator {
            display: flex;
            align-items: center;
            gap: var(--spacing-xs, 4px);
            padding: var(--spacing-xs, 4px) var(--spacing-sm, 8px);
            background: var(--score-poor-bg, rgba(239, 68, 68, 0.15));
            border: 1px solid var(--error, #ef4444);
            border-radius: var(--radius-sm, 4px);
            font-size: var(--font-xs, 0.625rem);
            font-weight: 600;
            color: var(--error, #ef4444);
            margin-bottom: var(--spacing-xs, 4px);
        }

        .busy-icon {
            display: inline-block;
            animation: pulse 1.5s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .busy-text {
            text-transform: uppercase;
        }

        .model-card-remove {
            position: absolute;
            top: 2px;
            right: 2px;
            width: 16px;
            height: 16px;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: var(--font-sm);
            line-height: 16px;
            text-align: center;
            border-radius: 2px;
            opacity: 0;
            transition: opacity var(--dur, 0.2s) var(--ease, ease);
            padding: 0;
        }
        .model-card:hover .model-card-remove {
            opacity: 1;
        }
        .model-card-remove:hover {
            background: var(--error, #ef4444);
            color: white;
        }

        /* Model Card - Concurrency Bar (Enhanced) */
        .model-card-bar {
            height: 16px;
            background: var(--bg-card);
            border-radius: 3px;
            overflow: hidden;
            position: relative;
            margin-top: 4px;
        }
        .model-card-bar-fill {
            height: 100%;
            border-radius: 3px;
            transition: width var(--dur, 0.2s) var(--ease, ease);
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 4px;
            min-width: 0;
        }
        .model-card-bar-fill.bar-low { background: var(--success, #10b981); }
        .model-card-bar-fill.bar-medium { background: var(--warning, #f59e0b); }
        .model-card-bar-fill.bar-high { background: var(--error, #ef4444); }
        .model-card-bar-fill.bar-cooled { background: var(--text-secondary); }

        /* Concurrency value inside bar */
        .model-card-bar-text {
            font-size: 0.6rem;
            font-weight: 600;
            color: white;
            white-space: nowrap;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }

        /* Concurrency value outside bar (when bar is too small) */
        .model-card-bar-outer {
            position: absolute;
            right: 4px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 0.6rem;
            font-weight: 500;
            color: var(--text-secondary);
            font-family: var(--font-mono, monospace);
        }

        /* Model card bar with usage label */
        .model-card-usage {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 2px;
            font-size: 0.6rem;
            color: var(--text-secondary);
        }
        .model-card-usage .usage-current {
            font-family: var(--font-mono, monospace);
            font-weight: 600;
            color: var(--text-primary);
        }

        /* Model Card Metadata Row */
        .model-card-meta {
            display: flex;
            align-items: center;
            gap: 6px;
            flex-wrap: wrap;
        }
        .model-card-tier {
            font-size: var(--font-xs, 0.625rem);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            padding: 1px 4px;
            border-radius: 2px;
        }
        .model-card-tier.tier-heavy {
            background: color-mix(in srgb, var(--error, #ef4444) 15%, transparent);
            color: var(--error, #ef4444);
        }
        .model-card-tier.tier-medium {
            background: color-mix(in srgb, var(--warning, #eab308) 15%, transparent);
            color: var(--warning, #eab308);
        }
        .model-card-tier.tier-light {
            background: color-mix(in srgb, var(--success, #22c55e) 15%, transparent);
            color: var(--success, #22c55e);
        }
        .model-card-tier.tier-free {
            background: color-mix(in srgb, var(--accent, #6366f1) 15%, transparent);
            color: var(--accent, #6366f1);
        }
        .model-card-slots {
            font-size: var(--font-xs, 0.625rem);
            color: var(--text-secondary);
        }
        .model-card-slots::before {
            content: '\2261 ';
        }
        .model-card-price {
            font-size: var(--font-xs, 0.625rem);
            color: var(--text-secondary);
            font-variant-numeric: tabular-nums;
        }
        .model-card-vision {
            font-size: var(--font-xs, 0.625rem);
            font-weight: 700;
            color: var(--accent, #6366f1);
            background: color-mix(in srgb, var(--accent, #6366f1) 10%, transparent);
            padding: 0 3px;
            border-radius: 2px;
            line-height: 1.2;
        }

        /* Model Card Tooltip */
        .model-card-tooltip {
            position: absolute;
            z-index: 1000;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 10px 14px;
            font-size: var(--font-sm, 0.75rem);
            line-height: 1.5;
            max-width: 280px;
            box-shadow: 0 4px 16px color-mix(in srgb, var(--shadow-color, #000) 25%, transparent);
            pointer-events: none;
        }
        .model-card-tooltip strong { color: var(--text-primary); }
        .model-card-tooltip .tooltip-desc { color: var(--text-secondary); font-size: var(--font-xs, 0.625rem); margin: 2px 0 4px; }
        .model-card-tooltip hr { border: none; border-top: 1px solid var(--border); margin: 6px 0; }
        .model-card-tooltip .tooltip-id { color: var(--text-secondary); font-size: var(--font-xs, 0.625rem); }
        .model-card-tooltip .tooltip-header { margin-bottom: 2px; }
        .tooltip-row {
            display: flex;
            justify-content: space-between;
            gap: 12px;
        }
        .tooltip-label { color: var(--text-secondary); }
        .tooltip-value { color: var(--text-primary); font-weight: 500; text-align: right; }

        /* Bank Sort Dropdown */
        .models-bank-sort {
            margin-left: auto;
            font-size: var(--font-xs, 0.625rem);
            padding: 2px 6px;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            color: var(--text-primary);
            border-radius: var(--radius-sm, 4px);
            cursor: pointer;
        }
        .models-bank-sort:focus {
            border-color: var(--accent);
            outline: none;
        }

        /* Pending Changes Bar */
        .tier-builder-actions {
            display: flex;
            justify-content: flex-end;
            align-items: center;
            gap: var(--spacing-sm, 8px);
            padding-top: var(--spacing-sm, 8px);
            border-top: 1px solid var(--border);
        }
        .pending-badge {
            font-size: var(--font-xs, 0.75rem);
            color: var(--warning, #f59e0b);
            background: color-mix(in srgb, var(--warning, #f59e0b) 10%, transparent);
            padding: 2px 8px;
            border-radius: var(--radius-sm, 4px);
            font-weight: 600;
            margin-right: auto;
        }
        .pending-badge-count {
            font-weight: 700;
        }

        /* SortableJS drag states */
        .sortable-ghost {
            opacity: 0.4;
            border: 2px dashed var(--accent);
            background: color-mix(in srgb, var(--accent) 5%, transparent);
        }
        .sortable-chosen {
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
            transform: scale(1.02);
        }
        .sortable-drag {
            opacity: 0.9;
        }
        .tier-lane.sortable-drag-over {
            border-color: var(--accent);
            background: color-mix(in srgb, var(--accent) 3%, var(--bg-card));
        }

        /* Responsive: stack lanes vertically on small screens */
        @media (max-width: 900px) {
            .tier-lanes {
                grid-template-columns: 1fr;
            }
            .routing-tab-btn { font-size: var(--font-sm); padding: var(--spacing-xs) var(--spacing-sm); }
        }

        .routing-test-form {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--spacing-sm);
            padding: var(--spacing-md);
            background: var(--bg-secondary);
            border-radius: 8px;
            margin-top: 8px;
        }
        .routing-test-form label {
            font-size: var(--font-sm);
            color: var(--text-secondary);
        }
        .routing-test-form input, .routing-test-form select {
            background: var(--bg-card);
            border: 1px solid var(--border);
            color: var(--text-primary);
            padding: var(--spacing-xs) var(--spacing-sm);
            border-radius: 4px;
            font-size: var(--font-base);
        }
        .routing-test-result {
            grid-column: 1 / -1;
            padding: var(--spacing-sm);
            background: var(--bg-card);
            border-radius: 6px;
            font-size: var(--font-base);
            display: none;
        }
        .routing-test-result.visible {
            display: block;
        }
        .routing-section-toggle {
            cursor: pointer;
            user-select: none;
        }
        .routing-section-toggle::before {
            content: '\25B6';
            display: inline-block;
            margin-right: 6px;
            transition: transform var(--dur) var(--ease);
            font-size: 0.7em;
        }
        .routing-section-toggle.open::before {
            transform: rotate(90deg);
        }
        .routing-collapsible {
            display: none;
        }
        .routing-collapsible.open {
            display: block;
        }

        /* Section Subtitle */
        .section-subtitle {
            font-size: var(--font-sm);
            font-weight: normal;
            color: var(--text-secondary);
            margin-left: 8px;
        }

        /* Live Flow Visualization (D3.js) */
        .live-flow-container {
            margin: var(--spacing-lg) 0;
            padding: var(--spacing-lg);
            background: var(--bg-secondary);
            border-radius: var(--radius-lg, 8px);
            border: 1px solid var(--border);
        }
        .live-flow-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-md, 12px);
        }
        .live-flow-header h4 {
            margin: 0;
            font-size: var(--font-sm, 0.85rem);
            color: var(--text-primary);
        }
        .live-flow-status {
            font-size: var(--font-xs, 0.75rem);
            color: var(--text-secondary);
            padding: 2px 8px;
            border-radius: var(--radius-sm, 4px);
            background: var(--bg-card);
        }
        .live-flow-status.connected {
            color: var(--success);
        }
        .live-flow-status.polling {
            color: var(--warning);
        }
        .live-flow-status.error {
            color: var(--error);
        }
        .live-flow-canvas {
            width: 100%;
            min-height: 120px;
            max-height: 300px;
            position: relative;
            overflow: hidden;
        }
        .live-flow-canvas svg {
            width: 100%;
            height: 100%;
            display: block;
        }
        .live-flow-empty {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 120px;
            color: var(--text-secondary);
            font-size: var(--font-sm, 0.85rem);
            font-style: italic;
        }
        .live-flow-legend {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: var(--spacing-lg, 16px);
            margin-top: var(--spacing-sm, 8px);
            font-size: var(--font-xs, 0.75rem);
            color: var(--text-secondary);
        }
        .legend-dot {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 4px;
            vertical-align: middle;
        }
        .legend-dot.legend-heavy {
            background: var(--error, #ef4444);
        }
        .legend-dot.legend-medium {
            background: var(--warning, #f59e0b);
        }
        .legend-dot.legend-light {
            background: var(--success, #10b981);
        }

        /* Swim-lane elements (rendered by D3.js) */
        .swim-lane-label {
            font-size: var(--font-xs);
            fill: var(--text-secondary);
            font-weight: 600;
        }
        .swim-lane-bg {
            fill: var(--bg-card);
            stroke: var(--border);
            stroke-width: 0.5;
            rx: 4;
        }
        .swim-lane-model {
            rx: 4;
            stroke-width: 1;
        }
        .swim-lane-model.tier-heavy {
            fill: color-mix(in srgb, var(--error) 15%, transparent);
            stroke: var(--error);
        }
        .swim-lane-model.tier-medium {
            fill: color-mix(in srgb, var(--warning) 15%, transparent);
            stroke: var(--warning);
        }
        .swim-lane-model.tier-light {
            fill: color-mix(in srgb, var(--success) 15%, transparent);
            stroke: var(--success);
        }
        .swim-lane-model-label {
            font-size: 9px;
            fill: var(--text-primary);
            text-anchor: middle;
            dominant-baseline: central;
        }
        .flow-particle {
            opacity: 0.8;
        }
        .flow-particle.tier-heavy { fill: var(--error); }
        .flow-particle.tier-medium { fill: var(--warning); }
        .flow-particle.tier-light { fill: var(--success); }
        .particle-counter {
            font-size: 9px;
            fill: var(--text-secondary);
            text-anchor: middle;
        }

        /* Reduced motion: no particle animation, instant transitions */
        @media (prefers-reduced-motion: reduce) {
            .flow-particle {
                display: none;
            }
            .live-flow-canvas svg * {
                transition: none !important;
                animation: none !important;
            }
        }


        /* Info Panel */
        .info-panel {
            margin: var(--spacing-md) 0;
            padding: 0;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 6px;
        }
        .info-panel summary {
            padding: var(--spacing-sm) var(--spacing-md);
            cursor: pointer;
            font-size: var(--font-base);
            color: var(--text-primary);
            user-select: none;
            list-style: none;
            display: flex;
            align-items: center;
        }
        .info-panel summary::-webkit-details-marker {
            display: none;
        }
        .info-panel summary::before {
            content: 'â–¸';
            display: inline-block;
            margin-right: 6px;
            transition: transform var(--dur) var(--ease);
        }
        .info-panel[open] summary::before {
            transform: rotate(90deg);
        }
        .info-panel summary:hover {
            background: var(--bg-card);
            border-radius: 6px;
        }
        .info-panel summary:focus {
            outline: 2px solid var(--accent);
            outline-offset: -2px;
            border-radius: 6px;
        }
        .info-panel-content {
            padding: 0 var(--spacing-md) 12px 12px;
            font-size: var(--font-base);
            color: var(--text-secondary);
            line-height: 1.5;
        }
        .info-panel-content ul {
            margin: var(--spacing-sm) 0 0 0;
            padding-left: 20px;
        }
        .info-panel-content li {
            margin: var(--spacing-xs) 0;
        }
        .info-panel-content a {
            color: var(--accent);
            text-decoration: none;
        }
        .info-panel-content a:hover {
            text-decoration: underline;
        }


        /* Status pill for routing */
        .routing-status-pill {
            padding: var(--spacing-xs, 4px) var(--spacing-sm, 8px);
            border-radius: 12px;
            font-size: var(--font-sm);
            background: var(--bg-tertiary, #333);
            color: var(--text-secondary);
            transition: all var(--dur) var(--ease);
        }
        .routing-status-pill.active {
            background: var(--accent);
            color: #fff;
            font-weight: 600;
        }
